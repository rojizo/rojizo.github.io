{% if bibitem.authors.size == 1 or bibitem.authors.size > 4 %}
  {% assign author = bibitem.authors | first %}
  <span class="author">
    {% assign name = author.name | split: ',' %}
    {% assign words = name | last | strip | split: ' ' %}
    {% for word in words %}{{ word | truncate: 2, '.' }}{% endfor %}
    {{ name | first }}{% if bibitem.authors.size > 4 %}
      <em>et al</em>{% endif %}</span>{% else %}
  {% for author in bibitem.authors %}<span class="author
    {% if forloop.first%}{% elsif forloop.last %}
      last
    {% else %}
      middle
    {% endif %}">
    {% assign name = author.name | split: ',' %}
    {% assign words = name | last | strip | split: ' ' %}
    {% for word in words %}{{ word | truncate: 2, '.' }}{% endfor %}
    {{ name | first }}</span>{% endfor %}{% endif %}